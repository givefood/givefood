{% extends "public/page.html" %}

{% block head %}
  <link rel="stylesheet" href="/static/css/wfbn.css">
  <link rel="stylesheet" href="/static/css/share_btns.css">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@GiveFoodCharity">
  <meta property="og:title" content="What Food Banks Need">
  <meta property="og:description" content="Use Give Food's tool to find what food banks near you are asking to have donated">
  <meta name="description" content="Use Give Food's tool to find what food banks near you are requesting to have donated">
  <meta property="og:image" content="https://www.givefood.org.uk/static/img/map.png">
  <link rel="manifest" href="/needs/manifest.json">
  <link rel="preload" href="/static/img/loading.gif" as="image">
{% endblock %}

{% block title %}What Food Banks Need - Give Food{% endblock %}

{% block body %}

  <div class="columns">
    <div class="column">
      <a href="/" class="logo"><img src="/static/img/logo.svg" alt="Give Food"></a>
    </div>
  </div>

  <div class="columns">
    <div class="column is-half">

      <p>Find a food bank near you, see what they need and how you can help by donating, volunteering or writing to your MP.</p>

      <a id="usemylocationbtn" href="{% url 'wfbn:get_location' %}" class="button is-light is-info">Use my location</a>
      <form id="addressform" action="/needs/" method="GET">
        <label id="address_label" for="address_field" class="label">Postcode or town</label>
        <input id="address_field" type="text" name="address" class="input" placeholder="e.g. EX4 6PX or Sheffield" value="{{ address }}" required>
        <input type="submit" class="button is-light is-info" value="Go">
      </form>

      <p id="status-msg"></p>

      <div id="index_intro">
        {% if not location_results %}
          <ul>
              <li><a href="{% url 'wfbn:constituencies' %}">Browse by Parliamentary Constituency</a></li>
              <li><a href="/register-foodbank/">Register a Food Bank</a></li>
              <li><a href="/about-us/">About Us</a></li>
          </ul>
          <br>
          <h2>Recently updated</h2>
          <ul class="recently-updated">
              {% for foodbank in recently_updated %}
                  <li><a href="{% url 'wfbn:foodbank' foodbank.foodbank_name_slug %}">{{ foodbank.foodbank_name }}</a></li>
              {% endfor %}
          </ul>
          
          {% url 'wfbn:index' as share_url %}
          {% include "wfbn/foodbank/includes/share_btns.html" with share_url=share_url %}
        {% endif %}
      </div>

      <div id="theresults">
            
        <table class="table needs">
          {% if location_results %}
            {% for location in location_results %}
              <tr>
                <td>
                  <a href="/needs/click/{{ location.foodbank_slug }}/" class="foodbank" target="_top">{{ location.name }}</a>
                  {% if where_from != "trusselltrust" %}
                    {% if location.type == "location" %}
                      <div class="parent_org">Part of <a href="/needs/at/{{ location.foodbank_slug }}/">{{ location.foodbank_name }}</a></div>
                    {% endif %}
                  {% endif %}
                  <div class="distance">{{ location.distance_mi|floatformat:2 }}mi away</div>
                  <div class="links">
                    {% if location.phone %}
                      <a class="phone" href="tel:{{ location.phone }}" title="Call the food bank"><img src="/static/img/phone.svg" alt="Phone"></a>
                    {% endif %}
                    <a class="info" href="/needs/at/{{ location.foodbank_slug }}/{% if location.type == "location" %}{{ location.slug }}/{% endif %}" title="More information"><img src="/static/img/info.svg" alt="Information"></a>
                  </div>
                  {% if location.needs != "Nothing" and location.needs != "Unknown" and location.needs != "Facebook" %}
                    <a class="subscribe-btn button is-link is-small" data-foodbankname="{{ location.foodbank_name }}">Get Updates</a>
                  {% endif %}
                  
                </td>
                <td class="need_detail">
                  <div class="fb_needs">
                    {% if location.needs == "Nothing" %}
                      Nothing right now, thanks
                    {% elif location.needs == "Unknown" %}
                      Sorry. We don't know what's needed here, please contact the food bank
                    {% elif location.needs == "Facebook" %}
                      Check the food bank's Facebook page for what they need
                    {% else %}
                      {{ location.needs|linebreaks }}
                    {% endif %}
                  </div>
                </td>
              </tr>
            {% endfor %}
          {% endif %}
        </table>
      </div>

    </div>
    <div class="column is-half">
      <div id="map"></div>
  </div>
  </div>
<!-- 
    
      <div class="columns">
        <div class="column is-6">

          <p>Find a food bank near you, see what they need and how you can help by donating, volunteering or writing to your MP.</p>
            
          {% include "wfbn/foodbank/includes/search_form.html" with is_index=True%}

          <p id="status-msg"></p>

          <div id="index_intro">
            {% if not location_results %}
            <ul>
                <li><a href="{% url 'wfbn:constituencies' %}">Browse by Parliamentary Constituency</a></li>
                <li><a href="{% url 'public_reg_foodbank' %}">Register a Food Bank</a></li>
                <li><a href="{% url 'public_index' %}">About Give Food</a></li>
            </ul>
            <br>
            <h2>Recently updated</h2>
            <ul class="recently-updated">
                {% for foodbank in recently_updated %}
                    <li><a href="{% url 'wfbn:foodbank' foodbank.foodbank_name_slug %}">{{ foodbank.foodbank_name }}</a></li>
                {% endfor %}
            </ul>
            {% endif %}
          </div>

          <p id="status"></p>

          <div id="theresults">
            
            <table class="table needs">
              {% if location_results %}
                {% for location in location_results %}
                  <tr>
                    <td>
                      <a href="/needs/click/{{ location.foodbank_slug }}/" class="foodbank" target="_top">{{ location.name }}</a>
                      {% if where_from != "trusselltrust" %}
                        {% if location.type == "location" %}
                          <div class="parent_org">Part of <a href="/needs/at/{{ location.foodbank_slug }}/">{{ location.foodbank_name }}</a></div>
                        {% endif %}
                      {% endif %}
                      <div class="distance">{{ location.distance_mi|floatformat:2 }}mi away</div>
                      <div class="links">
                        {% if location.phone %}
                          <a class="phone" href="tel:{{ location.phone }}" title="Call the food bank"><img src="/static/img/phone.svg" alt="Phone"></a>
                        {% endif %}
                        <a class="info" href="/needs/at/{{ location.foodbank_slug }}/{% if location.type == "location" %}{{ location.slug }}/{% endif %}" title="More information"><img src="/static/img/info.svg" alt="Information"></a>
                      </div>
                      {% if location.needs != "Nothing" and location.needs != "Unknown" and location.needs != "Facebook" %}
                        <a class="subscribe-btn button is-link is-small" data-foodbankname="{{ location.foodbank_name }}">Get Updates</a>
                      {% endif %}
                      
                    </td>
                    <td class="need_detail">
                      <div class="fb_needs">
                        {% if location.needs == "Nothing" %}
                          Nothing right now, thanks
                        {% elif location.needs == "Unknown" %}
                          Sorry. We don't know what's needed here, please contact the food bank
                        {% elif location.needs == "Facebook" %}
                          Check the food bank's Facebook page for what they need
                        {% else %}
                          {{ location.needs|linebreaks }}
                        {% endif %}
                      </div>
                    </td>
                  </tr>
                {% endfor %}
              {% endif %}
            </table>
          </div>



        </div>
        <div class="column is-6">
            <div id="map" class="sidemap full-uk-map"></div>
        </div>
      </div> -->

    </div>
  </div>

  <template id="fb_row">
    <tr>
      <td>
        <a href="#" class="foodbank" target="_top"></a>
        <div class="parent_org"><span></span> <a href="#"></a></div>
        <div class="distance"><span></span>mi away</div>
        <div class="links">
          <a class="phone" href="" title="Call the food bank"><img src="/static/img/phone.svg" alt="Phone"></a>
          <a class="info" href="" title="More information"><img src="/static/img/info.svg" alt="Information"></a>
        </div>
        <button class="subscribe-btn button is-link is-small">Get Updates</button>
      </td>
      <td class="need_detail">
        <div class="fb_needs">
          <p></p>
        </div>
      </td>
    </tr>
  </template>

  <div class="modal">
    <div class="modal-background"></div>
    <div class="modal-content">
      <div class="box">
        <p id="subscribe" class="subscribe-tease">Get notified when <span class="foodbank-name"></span> food bank requests items...</p>
        <form action="#" method="post">
            <div class="field has-addons">
              <div class="control is-expanded">
                  <input class="input" id="email" maxlength="254" name="email" type="email" placeholder="Email address" required="required" autocomplete="email">
              </div>
              <div class="control">
                  <button type="submit" class="button is-link" id="subscribe_btn">Subscribe</button>
              </div>
            </div>
        </form>
        <p class="is-size-7 subscribe-hint">We'll never use your email address for anything else, and you can unsubscribe at any time.</p>
      </div>
    </div>
    <button class="modal-close is-large" aria-label="close"></button>
  </div>

{% endblock %}

{% block script %}

  {% if lat_lng %}
    <script>
      initial_lat_lng = "{{ lat_lng }}";
    </script>
  {% endif %}
  <script src="https://maps.googleapis.com/maps/api/js?key={{ gmap_key }}&libraries=places" defer></script>
  <script src="/static//js/wfbn.js" defer></script>
  <script src="/static//js/wfbn_map.js" defer></script>

{% endblock %}
